/**
 * Created by: Abhijit Kumar
 * email:abhijit.stack@gmail.com
 */

var Validation={Ajax_fields:[],fields:[],element:{},message:{list:[]}},ValidationTools={};Validation.report={issuccessful:!0,id:"",attribute:"",value:"",reset:function(){this.issuccessful=!0,this.id="",this.attribute="",this.value=""}},Validation.message.init=function(){Validation.message.list.email="Invalid Email format!",Validation.message.list.maxlength="maxlength exceeds",Validation.message.list.minlength="Minimum length",Validation.message.list.datefrom="You can't Enter To Date more than From Date",Validation.message.list.mobile="This is a mobile type",Validation.message.list.verify=" exists!!!"},Validation.message.add=function(t){var e=ValidationTools.getFunctionName(arguments.callee.caller);Validation.message.list[e]=t},Validation.message.get=function(){var t="";switch(Validation.report.attribute){case"minlength":t=Validation.message.list[Validation.report.attribute]+" is "+Validation.report.value;break;case"verify":t=Validation.report.id+" "+Validation.message.list[Validation.report.attribute];break;default:t=Validation.message.list[Validation.report.attribute]}return t},Validation.createStyle=function(){var t=document.createElement("style"),e=".ValidationErrMsg{margin:10px 0px;position:absolute;padding:5px 10px;background-color:#cc3309;border:1px;box-shadow:1px 1px 2px 1px #ee3309;font-size:12px;color:#fefefe;border-radius:3px;z-index:999999999} \n ";e+=".ErrMsgBorder{margin-top:-25px;position:absolute;width  : 0;height : 0;border-left   : 8px solid transparent;border-right  : 8px solid transparent;border-bottom : 12px solid #cc3309;}",t.innerHTML=e,document.body.appendChild(t)},ValidationTools.pattern=function(t,e,a){console.log(t,e,a);var i=new RegExp(a);console.log(i.test(t))},ValidationTools.toDateAndFromDate=function(t,e){var a=document.getElementById(e).value,i=new Date(t),n=new Date(a);return i.getFullYear()>n.getFullYear()?!1:i.getDate()>n.getDate()&&i.getMonth()>=n.getMonth()&&i.getFullYear()==n.getFullYear()?!1:!0},ValidationTools.ajaxRequest=function(t,e,a){var i=new XMLHttpRequest,n=a.name+"="+e;i.onreadystatechange=function(){if(4==i.readyState&&200==i.status){if("true"==i.responseText)return Validation.report.issuccessful=!0,!0;Validation.report.issuccessful=!1,Validation.report.id=t,Validation.report.attribute=t+"_verify",Validation.report.value="",Validation.message.list[Validation.report.attribute]=a.errormsg,Validation.showError()}},"get"==a.method.toLowerCase()?(i.open(a.method,a.url+"?"+n,!0),i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.send()):(i.open(a.method,a.url,!0),i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.send(n))},ValidationTools.getFunctionName=function(t){var e=t.toString();return e=e.substr("function ".length),e=e.substr(0,e.indexOf("("))},Object.prototype.Validation=function(id,attribute,value){var mystring=this.toString(),result;switch(attribute){case"minvalue":result=value>mystring?!1:!0;break;case"maxvalue":result=mystring>value?!1:!0;break;case"datefrom":result=ValidationTools.toDateAndFromDate(mystring,value);break;case"verify":result=ValidationTools.ajaxRequest(id,mystring,value);break;case"fixedlength":result=mystring.length!=value?!1:!0;break;case"custom":Validation.element.id=id,Validation.element.value=mystring,result=eval(value+"()");break;case"match":var match1=document.getElementById(id),match2=document.getElementById(value);result="undefined"!=match1?match1.value!=match2.value?!1:!0:!1;break;case"maxlength":result=mystring.length>value?!1:!0;break;case"minlength":result=mystring.length<value?!1:!0;break;case"required":result=0==mystring.length?!1:!0;break;case"pattern":result=ValidationTools.pattern(mystring,attribute,value)?!1:!0;break;case"type":switch(value){case"name":var patt=/^[a-z][a-z .]+$/gi;result=patt.test(mystring)?!0:!1;break;case"email":var patt=/^[a-z]+[a-zA-z0-9_.]*[@][a-z]+[.][a-z]+/gi;result=patt.test(mystring)?!0:!1;break;case"mobile":var patt=/^\d{10}$/g;result=patt.test(mystring)?!0:!1;break;case"dropdown":result="null"==mystring?!1:!0;break;case"radio":var myelement=document.getElementById(id);if(myelement.hasAttribute("name")){var myname=myelement.getAttribute("name");result=null==document.querySelector("input[name='"+myname+"']:checked")?!1:!0}}}return result},Validation.showError=function(){var t=document.createElement("div");document.getElementById(Validation.report.id);var e=document.getElementById(Validation.report.id).parentNode,a=document.getElementById(Validation.report.id),i=a.getBoundingClientRect().left-e.getBoundingClientRect().left;if(e&&a){var t=document.createElement("div");t.className="ValidationErrMsg";var n="";("custom"==Validation.report.attribute||"type"==Validation.report.attribute)&&(Validation.report.attribute=Validation.report.value),void 0!=Validation.message.list[Validation.report.attribute]?n=Validation.message.get():(n="Error: "+Validation.report.attribute,n+=1==Validation.report.value?" !!! ":" is "+Validation.report.value),t.innerHTML=n;var r=document.createElement("div");r.className="ErrMsgBorder",t.style.marginLeft=1+i+"px",t.appendChild(r),a.parentNode.insertBefore(t,a.nextSibling)}},Validation.inProgress=function(t){for(var e=0;e<Validation.fields[t].length;e++){for(var a=Object.keys(Validation.fields[t][e]),i=Validation.fields[t][e].id,n=document.getElementById(i).value,r=0;r<a.length;r++){var o=a[r],l=Validation.fields[t][e][o];if("id"!=o&&0==n.Validation(i,o,l)){Validation.report.issuccessful=!1,Validation.report.id=i,Validation.report.attribute=o,Validation.report.value=l;break}}if(!Validation.report.issuccessful){Validation.showError();break}}},Validation.ValidationErrMsgClear=function(){var t=document.getElementsByClassName("ValidationErrMsg");if(0!=t.length)for(var e=0;e<=t.length;e++){var a=t[e].parentNode;a.removeChild(t[e]),Validation.report.reset()}},Validation.onSubmitListiner=function(t,e){t.preventDefault(),Validation.ValidationErrMsgClear(),Validation.inProgress(e),Validation.report.issuccessful&&document.getElementById(e).submit()},Validation.Initiate=function(t){Validation.createStyle(),Validation.message.init();for(var e=0;e<t.length;e++){var a=t[e].toString();document.getElementById(a).addEventListener("submit",function(t){Validation.onSubmitListiner(t,this.id)},!1)}},Validation.getAjaxStatus=function(t){return Validation.ValidationErrMsgClear(),Validation.inProgress(t),Validation.report.issuccessful?!0:!1},Validation.Initiate=function(){Validation.createStyle(),Validation.message.init();var t=Object.keys(Validation.fields);console.log(Validation.fields);for(var e=0;e<t.length;e++){var a=t[e].toString();document.getElementById(a).addEventListener("submit",function(t){Validation.onSubmitListiner(t,this.id)},!1)}};
/**
 * Created by: Abhijit Kumar
 * email:abhijit.stack@gmail.com
 */

var Validation={element:{},message:{list:[]}},ValidationTools={};ValidationTools.pattern=function(t,e,a){console.log(t,e,a);var i=new RegExp(a);console.log(i.test(t))},ValidationTools.ajaxRequest=function(t,e,a){var i=new XMLHttpRequest,r=a.name+"="+e;i.onreadystatechange=function(){if(4==i.readyState&&200==i.status){if("true"==i.responseText)return!0;Validation.report.issuccessful=!1,Validation.report.id=t,Validation.report.attribute=t+"_verify",Validation.report.value="",Validation.message.list[Validation.report.attribute]=a.errormsg,Validation.showError()}},i.open(a.method,a.url,!0),i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.send(r)},Validation.report={issuccessful:!0,id:"",attribute:"",value:"",reset:function(){this.issuccessful=!0,this.id="",this.attribute="",this.value=""}},Validation.message.init=function(){Validation.message.list.maxlength="maxlength exceeds",Validation.message.list.minlength="Minimum length",Validation.message.list.mobile="This is a mobile type",Validation.message.list.verify=" exists!!!"},Validation.message.get=function(){var t="";switch(Validation.report.attribute){case"minlength":t=Validation.message.list[Validation.report.attribute]+" is "+Validation.report.value;break;case"verify":t=Validation.report.id+" "+Validation.message.list[Validation.report.attribute];break;default:t=Validation.message.list[Validation.report.attribute]}return t},Validation.functionName=function(t){var e=t.toString();return e=e.substr("function ".length),e=e.substr(0,e.indexOf("("))},Validation.message.add=function(t){var e=Validation.functionName(arguments.callee.caller);Validation.message.list[e]=t},Object.prototype.Validation=function(id,attribute,value){var mystring=this.toString(),result;switch(attribute){case"verify":result=ValidationTools.ajaxRequest(id,mystring,value);break;case"fixedlength":result=mystring.length!=value?!1:!0;break;case"custom":Validation.element.id=id,Validation.element.value=mystring,result=eval(value+"()");break;case"match":var match1=document.getElementById(id),match2=document.getElementById(value);result="undefined"!=match1?match1.value!=match2.value?!1:!0:!1;break;case"maxlength":result=mystring.length>value?!1:!0;break;case"minlength":result=mystring.length<value?!1:!0;break;case"required":result=0==mystring.length?!1:!0;break;case"pattern":result=ValidationTools.pattern(mystring,attribute,value)?!1:!0;break;case"type":switch(value){case"name":var patt=/^[a-z][a-z .]+$/gi;result=patt.test(mystring)?!0:!1;break;case"email":var patt=/^[a-z]+[a-zA-z0-9_.]*[@][a-z]+[.][a-z]+/gi;result=patt.test(mystring)?!0:!1;break;case"mobile":var patt=/^\d{10}$/g;result=patt.test(mystring)?!0:!1;break;case"dropdown":result="null"==mystring?!1:!0;break;case"radio":var myelement=document.getElementById(id);if(myelement.hasAttribute("name")){var myname=myelement.getAttribute("name");result=null==document.querySelector("input[name='"+myname+"']:checked")?!1:!0}}}return result},Validation.showError=function(){var t=document.createElement("div");document.getElementById(Validation.report.id);var e=document.getElementById(Validation.report.id).parentNode,a=document.getElementById(Validation.report.id),i=a.getBoundingClientRect().left;if(e&&a){var t=document.createElement("div");t.className="ValidationErrMsg";var r="";("custom"==Validation.report.attribute||"type"==Validation.report.attribute)&&(Validation.report.attribute=Validation.report.value),void 0!=Validation.message.list[Validation.report.attribute]?r=Validation.message.get():(r="Error: "+Validation.report.attribute,r+=1==Validation.report.value?" !!! ":" is "+Validation.report.value),t.innerHTML=r;var n=document.createElement("div");n.className="ErrMsgBorder",t.style.marginLeft=i+"px",t.appendChild(n),a.parentNode.insertBefore(t,a.nextSibling)}},Validation.inProgress=function(){for(var t=0;t<Validation.fields.length;t++){for(var e=Object.keys(Validation.fields[t]),a=Validation.fields[t].id,i=document.getElementById(a).value,r=0;r<e.length;r++){var n=e[r],o=Validation.fields[t][n];if("id"!=n&&0==i.Validation(a,n,o)){Validation.report.issuccessful=!1,Validation.report.id=a,Validation.report.attribute=n,Validation.report.value=o;break}}if(!Validation.report.issuccessful){Validation.showError();break}}},Validation.ValidationErrMsgClear=function(){var t=document.getElementsByClassName("ValidationErrMsg");if(0!=t.length){var e=t[0].parentNode;e.removeChild(t[0]),Validation.report.reset()}},Validation.Initiate=function(t){Validation.message.init(),document.getElementById(t).addEventListener("submit",function(e){e.preventDefault(),Validation.ValidationErrMsgClear(),Validation.inProgress(),Validation.report.issuccessful&&document.getElementById(t).submit()},!1)},Validation.createStyle=function(){var t=document.createElement("style"),e=".ValidationErrMsg{margin:10px 30px;position:absolute;padding:5px 10px;background-color:#cc3309;border:1px;box-shadow:1px 1px 2px 1px #ee3309;font-size:10px;color:#fefefe;border-radius:3px;} \n ";e+=".ErrMsgBorder{margin-top:-25px;position:absolute;width  : 0;height : 0;border-left   : 8px solid transparent;border-right  : 8px solid transparent;border-bottom : 12px solid #cc3309;}",t.innerHTML=e,document.body.appendChild(t)},Validation.createStyle();